<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jordan Salsman" />

<meta name="date" content="2019-10-24" />

<title>Case Study Beer</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">About Me</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="About-Me.html">About Me</a>
</li>
<li>
  <a href="Case-Study-Beer.html">Beer Case Study</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Case Study Beer</h1>
<h4 class="author">Jordan Salsman</h4>
<h4 class="date">10/24/2019</h4>

</div>


<p>Link to RShiny App:<br />
<a href="https://jsalsman7.shinyapps.io/Unit12/" class="uri">https://jsalsman7.shinyapps.io/Unit12/</a></p>
<div id="load-following-libraries" class="section level3">
<h3>Load following libraries</h3>
<p>ggplot2, and ggthemes - visualizations<br />
tidyverse<br />
naniar and visdat - visualizations for missing data<br />
mice and VIM - Imputation<br />
GGally, ggmap,treemapify, and lattice - visualizations<br />
stringr - regular expressions<br />
class and klaR - classificiation functions<br />
e1071 - Confusion Matrix<br />
ROCR - ROC Curve<br />
openintro - state to abbrevation function<br />
caret - Regression</p>
</div>
<div id="load-data-into-memory-from-csv" class="section level3">
<h3>Load data into memory from csv</h3>
<p>Load Breweries from csv<br />
Load Beers from csv<br />
Merge Breweries and Beers by the Brewery<br />
Rename Names column after merging two datasets</p>
<pre class="r"><code>breweries_ds &lt;- read.csv(&quot;/Users/jordansalsman/Desktop/Unit12/Unit12/Breweries.csv&quot;, strip.white = TRUE)
beers_ds     &lt;- read.csv(&quot;/Users/jordansalsman/Desktop/Unit12/Unit12/Beers.csv&quot;, strip.white= TRUE)
bmerged_ds   &lt;- merge(breweries_ds,beers_ds,by.x=&quot;Brew_ID&quot;,by.y=&quot;Brewery_id&quot;)
names(bmerged_ds)[2] &lt;- &quot;BreweryName&quot;
names(bmerged_ds)[5] &lt;- &quot;BeerName&quot;</code></pre>
</div>
<div id="structures-of-the-datasets" class="section level3">
<h3>Structures of the datasets</h3>
<p>breweries_ds - Breweries in USA<br />
beers_ds - Different beer styles with ABV and IBU and Ounces<br />
bmerged_ds - Merged dataset</p>
<pre class="r"><code>str(breweries_ds)</code></pre>
<pre><code>## &#39;data.frame&#39;:    558 obs. of  4 variables:
##  $ Brew_ID: int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Name   : Factor w/ 551 levels &quot;10 Barrel Brewing Company&quot;,..: 355 12 266 319 201 136 227 477 59 491 ...
##  $ City   : Factor w/ 384 levels &quot;Abingdon&quot;,&quot;Abita Springs&quot;,..: 228 200 122 299 300 62 91 48 152 136 ...
##  $ State  : Factor w/ 51 levels &quot;AK&quot;,&quot;AL&quot;,&quot;AR&quot;,..: 24 18 20 5 5 41 6 23 23 23 ...</code></pre>
<pre class="r"><code>str(beers_ds)</code></pre>
<pre><code>## &#39;data.frame&#39;:    2410 obs. of  7 variables:
##  $ Name      : Factor w/ 2304 levels &quot;#001 Golden Amber Lager&quot;,..: 1637 576 1703 1841 1818 267 1159 757 1092 485 ...
##  $ Beer_ID   : int  1436 2265 2264 2263 2262 2261 2260 2259 2258 2131 ...
##  $ ABV       : num  0.05 0.066 0.071 0.09 0.075 0.077 0.045 0.065 0.055 0.086 ...
##  $ IBU       : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ Brewery_id: int  409 178 178 178 178 178 178 178 178 178 ...
##  $ Style     : Factor w/ 100 levels &quot;&quot;,&quot;Abbey Single Ale&quot;,..: 19 18 16 12 16 80 18 22 18 12 ...
##  $ Ounces    : num  12 12 12 12 12 12 12 12 12 12 ...</code></pre>
<pre class="r"><code>str(bmerged_ds)</code></pre>
<pre><code>## &#39;data.frame&#39;:    2410 obs. of  10 variables:
##  $ Brew_ID    : int  1 1 1 1 1 1 2 2 2 2 ...
##  $ BreweryName: Factor w/ 551 levels &quot;10 Barrel Brewing Company&quot;,..: 355 355 355 355 355 355 12 12 12 12 ...
##  $ City       : Factor w/ 384 levels &quot;Abingdon&quot;,&quot;Abita Springs&quot;,..: 228 228 228 228 228 228 200 200 200 200 ...
##  $ State      : Factor w/ 51 levels &quot;AK&quot;,&quot;AL&quot;,&quot;AR&quot;,..: 24 24 24 24 24 24 18 18 18 18 ...
##  $ BeerName   : Factor w/ 2304 levels &quot;#001 Golden Amber Lager&quot;,..: 1639 1925 1524 801 1257 2184 71 457 1217 43 ...
##  $ Beer_ID    : int  2689 2688 2687 2692 2691 2690 2683 2686 2685 2684 ...
##  $ ABV        : num  0.06 0.06 0.056 0.045 0.049 0.048 0.042 0.08 0.125 0.077 ...
##  $ IBU        : int  38 25 47 50 26 19 42 68 80 25 ...
##  $ Style      : Factor w/ 100 levels &quot;&quot;,&quot;Abbey Single Ale&quot;,..: 83 22 57 16 77 48 18 12 46 77 ...
##  $ Ounces     : num  16 16 16 16 16 16 16 16 16 16 ...</code></pre>
</div>
<div id="merged-dataset" class="section level3">
<h3>Merged dataset</h3>
<p>First and last 10 records from merged set</p>
<pre class="r"><code>head(bmerged_ds)</code></pre>
<pre><code>##   Brew_ID       BreweryName        City State      BeerName Beer_ID   ABV
## 1       1 NorthGate Brewing Minneapolis    MN       Pumpion    2689 0.060
## 2       1 NorthGate Brewing Minneapolis    MN    Stronghold    2688 0.060
## 3       1 NorthGate Brewing Minneapolis    MN   Parapet ESB    2687 0.056
## 4       1 NorthGate Brewing Minneapolis    MN  Get Together    2692 0.045
## 5       1 NorthGate Brewing Minneapolis    MN Maggie&#39;s Leap    2691 0.049
## 6       1 NorthGate Brewing Minneapolis    MN    Wall&#39;s End    2690 0.048
##   IBU                               Style Ounces
## 1  38                         Pumpkin Ale     16
## 2  25                     American Porter     16
## 3  47 Extra Special / Strong Bitter (ESB)     16
## 4  50                        American IPA     16
## 5  26                  Milk / Sweet Stout     16
## 6  19                   English Brown Ale     16</code></pre>
<pre class="r"><code>tail(bmerged_ds)</code></pre>
<pre><code>##      Brew_ID                   BreweryName          City State
## 2405     556         Ukiah Brewing Company         Ukiah    CA
## 2406     557       Butternuts Beer and Ale Garrattsville    NY
## 2407     557       Butternuts Beer and Ale Garrattsville    NY
## 2408     557       Butternuts Beer and Ale Garrattsville    NY
## 2409     557       Butternuts Beer and Ale Garrattsville    NY
## 2410     558 Sleeping Lady Brewing Company     Anchorage    AK
##                       BeerName Beer_ID   ABV IBU                   Style
## 2405             Pilsner Ukiah      98 0.055  NA         German Pilsener
## 2406         Porkslap Pale Ale      49 0.043  NA American Pale Ale (APA)
## 2407           Snapperhead IPA      51 0.068  NA            American IPA
## 2408         Moo Thunder Stout      50 0.049  NA      Milk / Sweet Stout
## 2409  Heinnieweisse Weissebier      52 0.049  NA              Hefeweizen
## 2410 Urban Wilderness Pale Ale      30 0.049  NA        English Pale Ale
##      Ounces
## 2405     12
## 2406     12
## 2407     12
## 2408     12
## 2409     12
## 2410     12</code></pre>
</div>
<div id="summary-statistics-of-both-datasets" class="section level3">
<h3>Summary Statistics of both datasets</h3>
<p>breweries_ds - Breweries in USA<br />
beers_ds - Different beer styles with ABV and IBU<br />
bmerged_ds - Merged dataset</p>
<pre class="r"><code>summary(breweries_ds)</code></pre>
<pre><code>##     Brew_ID                           Name           City    
##  Min.   :  1.0   Blackrocks Brewery     :  2   Portland: 17  
##  1st Qu.:140.2   Blue Mountain Brewery  :  2   Boulder :  9  
##  Median :279.5   Lucette Brewing Company:  2   Chicago :  9  
##  Mean   :279.5   Oskar Blues Brewery    :  2   Seattle :  9  
##  3rd Qu.:418.8   Otter Creek Brewing    :  2   Austin  :  8  
##  Max.   :558.0   Sly Fox Brewing Company:  2   Denver  :  8  
##                  (Other)                :546   (Other) :498  
##      State    
##  CO     : 47  
##  CA     : 39  
##  MI     : 32  
##  OR     : 29  
##  TX     : 28  
##  PA     : 25  
##  (Other):358</code></pre>
<pre class="r"><code>summary(beers_ds)</code></pre>
<pre><code>##                      Name         Beer_ID            ABV         
##  Nonstop Hef Hop       :  12   Min.   :   1.0   Min.   :0.00100  
##  Dale&#39;s Pale Ale       :   6   1st Qu.: 808.2   1st Qu.:0.05000  
##  Oktoberfest           :   6   Median :1453.5   Median :0.05600  
##  Longboard Island Lager:   4   Mean   :1431.1   Mean   :0.05977  
##  1327 Pod&#39;s ESB        :   3   3rd Qu.:2075.8   3rd Qu.:0.06700  
##  Boston Lager          :   3   Max.   :2692.0   Max.   :0.12800  
##  (Other)               :2376                    NA&#39;s   :62       
##       IBU           Brewery_id                               Style     
##  Min.   :  4.00   Min.   :  1.0   American IPA                  : 424  
##  1st Qu.: 21.00   1st Qu.: 94.0   American Pale Ale (APA)       : 245  
##  Median : 35.00   Median :206.0   American Amber / Red Ale      : 133  
##  Mean   : 42.71   Mean   :232.7   American Blonde Ale           : 108  
##  3rd Qu.: 64.00   3rd Qu.:367.0   American Double / Imperial IPA: 105  
##  Max.   :138.00   Max.   :558.0   American Pale Wheat Ale       :  97  
##  NA&#39;s   :1005                     (Other)                       :1298  
##      Ounces     
##  Min.   : 8.40  
##  1st Qu.:12.00  
##  Median :12.00  
##  Mean   :13.59  
##  3rd Qu.:16.00  
##  Max.   :32.00  
## </code></pre>
<pre class="r"><code>summary(bmerged_ds)</code></pre>
<pre><code>##     Brew_ID                          BreweryName             City     
##  Min.   :  1.0   Brewery Vivant            :  62   Grand Rapids:  66  
##  1st Qu.: 94.0   Oskar Blues Brewery       :  46   Portland    :  64  
##  Median :206.0   Sun King Brewing Company  :  38   Chicago     :  55  
##  Mean   :232.7   Cigar City Brewing Company:  25   Indianapolis:  43  
##  3rd Qu.:367.0   Sixpoint Craft Ales       :  24   San Diego   :  42  
##  Max.   :558.0   Hopworks Urban Brewery    :  23   Boulder     :  41  
##                  (Other)                   :2192   (Other)     :2099  
##      State                        BeerName       Beer_ID      
##  CO     : 265   Nonstop Hef Hop       :  12   Min.   :   1.0  
##  CA     : 183   Dale&#39;s Pale Ale       :   6   1st Qu.: 808.2  
##  MI     : 162   Oktoberfest           :   6   Median :1453.5  
##  IN     : 139   Longboard Island Lager:   4   Mean   :1431.1  
##  TX     : 130   1327 Pod&#39;s ESB        :   3   3rd Qu.:2075.8  
##  OR     : 125   Boston Lager          :   3   Max.   :2692.0  
##  (Other):1406   (Other)               :2376                   
##       ABV               IBU                                    Style     
##  Min.   :0.00100   Min.   :  4.00   American IPA                  : 424  
##  1st Qu.:0.05000   1st Qu.: 21.00   American Pale Ale (APA)       : 245  
##  Median :0.05600   Median : 35.00   American Amber / Red Ale      : 133  
##  Mean   :0.05977   Mean   : 42.71   American Blonde Ale           : 108  
##  3rd Qu.:0.06700   3rd Qu.: 64.00   American Double / Imperial IPA: 105  
##  Max.   :0.12800   Max.   :138.00   American Pale Wheat Ale       :  97  
##  NA&#39;s   :62        NA&#39;s   :1005     (Other)                       :1298  
##      Ounces     
##  Min.   : 8.40  
##  1st Qu.:12.00  
##  Median :12.00  
##  Mean   :13.59  
##  3rd Qu.:16.00  
##  Max.   :32.00  
## </code></pre>
</div>
<div id="visual-summary" class="section level3">
<h3>Visual Summary</h3>
<p>Total Breweries per state<br />
Bar Chart</p>
<pre class="r"><code>b_states &lt;- breweries_ds %&gt;% group_by(State) %&gt;% count() %&gt;% arrange(desc(n))
b_states$State &lt;- factor(b_states$State, levels = b_states$State) 
ggplot(b_states, aes(x=State, y=n)) + 
  geom_bar(stat=&quot;identity&quot;, width=.8, fill=&quot;tomato3&quot;) + 
  labs(title=&quot;Ordered Bar Chart&quot;, 
       subtitle=&quot;State Vs Number of Breweries&quot;, 
       caption=&quot;Beer Analysis&quot;) + 
  xlab(&quot;State&quot;)+
  ylab(&quot;Total Breweries&quot;)+
  theme_wsj()+
  theme(axis.text.x = element_text(angle=65, vjust=0.6))+  
  theme(plot.title    = element_text(size = rel(0.5)),
  plot.subtitle = element_text(size = rel(0.5)),
  axis.text.x   = element_text(vjust=0.6,size=10),
  axis.title    = element_text(size = rel(0.5)),
  legend.position  = &quot;right&quot;,
  legend.direction =&quot;vertical&quot;,
  legend.title = element_text(size = rel(0.2)))</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="more-visual-summary" class="section level3">
<h3>More Visual Summary</h3>
<p>Heat Map of Breweries per state</p>
<pre class="r"><code>states &lt;- map_data(&quot;state&quot;)
states$region &lt;- state2abbr(states$region)
colnames(states)[colnames(states)==&quot;region&quot;] &lt;- &quot;State&quot;
Brew_count &lt;- breweries_ds %&gt;% group_by(State) %&gt;% count(State)
full &lt;- merge(x = states, y = Brew_count, by = &quot;State&quot;)
ggplot() + 
 geom_polygon(data=full, aes(x=long, y=lat, group = group, fill = n),colour=&quot;black&quot;)+
 coord_fixed()+ guides(fill=guide_legend(title=&quot;Number of Breweries&quot;)) + theme_classic() +     ggtitle(&quot;The Number of Breweries Across The Country&quot;) + annotate(&quot;text&quot;,x = -120, y = 31, label = &quot;Alaska = 7&quot;) + annotate(&quot;text&quot;,x = -120, y = 28, label = &quot;Hawaii = 4&quot;) + geom_text(label = n)</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="missing-values-along-state-variable" class="section level3">
<h3>Missing Values along State Variable</h3>
<p>breweris_ds - Breweries in USA<br />
beers_ds - Different beer styles with ABV and IBU<br />
—Not randomly missing throughout</p>
<pre class="r"><code>beer_ounces &lt;- beers_ds
beer_ounces$Ounces &lt;- as.factor(beer_ounces$Ounces)
gg_miss_var(bmerged_ds,facet=State)+
  theme_wsj()+
  theme(axis.text.x = element_text(angle=65, vjust=0.3))+  
  theme(plot.title    = element_text(size = rel(0.5)),
  plot.subtitle = element_text(size = rel(0.5)),
  axis.text.x   = element_text(vjust=0.6,size=8),
  axis.text.y   = element_text(vjust=0.2,size=4),
  axis.title    = element_text(size = rel(0.5)),
  legend.position  = &quot;right&quot;,
  legend.direction =&quot;vertical&quot;,
  legend.title = element_text(size = rel(0.2)))</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(data)`</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="imputations" class="section level3">
<h3>Imputations</h3>
<p>62 records doens’t have IBU and SBV both - these are deleted<br />
Total records to process 2410-62 = 2348<br />
Prediction is required on 943 missing IBU<br />
Total records with IBU is 1405<br />
Replacing with Linear Regression Imputations</p>
<pre class="r"><code>bmerged_final_ds &lt;- bmerged_ds %&gt;% filter(!is.na(ABV) | !is.na(IBU))
non_missing_ibu &lt;- bmerged_final_ds %&gt;% filter(!is.na(IBU))
non_missing_ibu$imputed &lt;- &quot;N&quot;
missing_ibu &lt;- bmerged_final_ds %&gt;% filter(is.na(IBU))
missing_ibu$imputed &lt;- &quot;Y&quot;
model_ibu &lt;- non_missing_ibu %&gt;% lm(formula=log(IBU)~log(ABV))
summary(model_ibu)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log(IBU) ~ log(ABV), data = .)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.81374 -0.30156  0.08312  0.38514  1.35081 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  8.99667    0.18115   49.66   &lt;2e-16 ***
## log(ABV)     1.91683    0.06363   30.12   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.514 on 1403 degrees of freedom
## Multiple R-squared:  0.3927, Adjusted R-squared:  0.3923 
## F-statistic: 907.4 on 1 and 1403 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>missing_ibu$IBU &lt;- round(exp(predict(model_ibu,missing_ibu)),0)
imputed_df &lt;- rbind(non_missing_ibu,missing_ibu)
imputed_df$imputed &lt;- as.factor(imputed_df$imputed)
imputed_df %&gt;% ggplot(aes(x=ABV,y=IBU,color=imputed))+
               geom_point()+ggtitle(&quot;ABV Vs IBU&quot;) + 
               theme_wsj()+
               theme(axis.text.x = element_text(angle=65, vjust=0.3))+  
               theme(plot.title    = element_text(size = rel(0.5)),
               plot.subtitle = element_text(size = rel(0.5)),
               axis.text.x   = element_text(vjust=0.6,size=8),
               axis.text.y   = element_text(vjust=0.2,size=6),
               axis.title    = element_text(size = rel(0.5)),
               legend.position  = &quot;right&quot;,
               legend.direction =&quot;vertical&quot;,
               legend.title = element_text(size = rel(0.5)))</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="state-vs-median-abv-bar-chart" class="section level3">
<h3>State Vs Median ABV Bar Chart</h3>
<pre class="r"><code>abv_by_states &lt;- imputed_df  %&gt;% group_by(State) %&gt;%  summarise(Median=as.numeric(median(ABV))) %&gt;% arrange(desc(Median))
abv_by_states$State &lt;- factor(abv_by_states$State, levels = abv_by_states$State) 
ggplot(abv_by_states, aes(x=State, y=Median)) + 
  geom_bar(stat=&quot;identity&quot;, width=.8, fill=&quot;tomato3&quot;) + 
  labs(title=&quot;Ordered Bar Chart&quot;, 
       subtitle=&quot;Median ABV Vs State&quot;, 
       caption=&quot;Beer Analysis&quot;) + 
  xlab(&quot;State&quot;)+
  ylab(&quot;Alcohol content&quot;)+
  theme_wsj()+
  theme(axis.text.x = element_text(angle=65, vjust=0.6))+  
  theme(plot.title    = element_text(size = rel(0.5)),
  plot.subtitle = element_text(size = rel(0.5)),
  axis.text.x   = element_text(vjust=0.6,size=7),
  axis.title    = element_text(size = rel(0.5)),
  legend.position  = &quot;right&quot;,
  legend.direction =&quot;vertical&quot;,
  legend.title = element_text(size = rel(0.2)))</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="state-vs-median-bitterness-barchart" class="section level3">
<h3>State Vs Median Bitterness Barchart</h3>
<pre class="r"><code>ibu_by_states &lt;- imputed_df %&gt;% group_by(State) %&gt;%  summarise(Median=as.numeric(median(IBU))) %&gt;% arrange(desc(Median))
ibu_by_states$State &lt;- factor(ibu_by_states$State, levels = ibu_by_states$State) 
ggplot(ibu_by_states, aes(x=State, y=Median)) + 
  geom_bar(stat=&quot;identity&quot;, width=.8, fill=&quot;tomato3&quot;) + 
  labs(title=&quot;Ordered Bar Chart&quot;, 
       subtitle=&quot;Median IBU Vs State&quot;, 
       caption=&quot;Beer Analysis&quot;) + 
  xlab(&quot;State&quot;)+
  ylab(&quot;Bitterness&quot;)+
  theme_wsj()+
  theme(axis.text.x = element_text(angle=65, vjust=0.6))+  
  theme(plot.title    = element_text(size = rel(0.5)),
  plot.subtitle = element_text(size = rel(0.5)),
  axis.text.x   = element_text(vjust=0.6,size=7),
  axis.title    = element_text(size = rel(0.5)),
  legend.position  = &quot;right&quot;,
  legend.direction =&quot;vertical&quot;,
  legend.title = element_text(size = rel(0.2)))</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="max-abv" class="section level3">
<h3>Max ABV</h3>
<pre class="r"><code>max(imputed_df$ABV)</code></pre>
<pre><code>## [1] 0.128</code></pre>
<pre class="r"><code>which.max(imputed_df$ABV)</code></pre>
<pre><code>## [1] 1569</code></pre>
<pre class="r"><code>print(imputed_df[1569,])</code></pre>
<pre><code>##      Brew_ID             BreweryName    City State
## 1569      52 Upslope Brewing Company Boulder    CO
##                                                  BeerName Beer_ID   ABV
## 1569 Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale    2565 0.128
##      IBU            Style Ounces imputed
## 1569 157 Quadrupel (Quad)   19.2       Y</code></pre>
</div>
<div id="distribution-of-abv" class="section level3">
<h3>Distribution of ABV</h3>
<p>Boxplot ABV</p>
<pre class="r"><code>ibu_by_states &lt;- imputed_df %&gt;% group_by(State) %&gt;%  arrange(desc(ABV))
ibu_by_states$State &lt;- factor(ibu_by_states$State, levels = unique(ibu_by_states$State)) 
str(ibu_by_states)</code></pre>
<pre><code>## Classes &#39;grouped_df&#39;, &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:  2348 obs. of  11 variables:
##  $ Brew_ID    : int  52 2 18 52 47 25 26 26 26 26 ...
##  $ BreweryName: Factor w/ 551 levels &quot;10 Barrel Brewing Company&quot;,..: 521 12 500 521 438 104 467 467 467 467 ...
##  $ City       : Factor w/ 384 levels &quot;Abingdon&quot;,&quot;Abita Springs&quot;,..: 43 200 113 43 50 220 160 160 160 160 ...
##  $ State      : Factor w/ 51 levels &quot;CO&quot;,&quot;KY&quot;,&quot;IN&quot;,..: 1 2 3 1 4 3 3 3 3 3 ...
##  $ BeerName   : Factor w/ 2304 levels &quot;#001 Golden Amber Lager&quot;,..: 1181 1217 515 1180 54 1012 335 334 1104 337 ...
##  $ Beer_ID    : int  2565 2685 2621 2564 2574 2471 2083 1367 394 1049 ...
##  $ ABV        : num  0.128 0.125 0.12 0.104 0.1 0.099 0.099 0.099 0.099 0.099 ...
##  $ IBU        : num  157 80 90 105 52 115 36 75 60 60 ...
##  $ Style      : Factor w/ 100 levels &quot;&quot;,&quot;Abbey Single Ale&quot;,..: 84 46 88 89 27 12 28 88 46 46 ...
##  $ Ounces     : num  19.2 16 16 19.2 12 12 16 16 16 16 ...
##  $ imputed    : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 2 1 1 2 1 1 1 1 1 1 ...
##  - attr(*, &quot;groups&quot;)=Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   51 obs. of  2 variables:
##   ..$ State: Factor w/ 51 levels &quot;AK&quot;,&quot;AL&quot;,&quot;AR&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##   ..$ .rows:List of 51
##   .. ..$ : int  581 682 794 795 883 906 1039 1091 1115 1116 ...
##   .. ..$ : int  65 378 927 947 948 998 1092 1215 1644 1770
##   .. ..$ : int  889 1161 1582 1809 2284
##   .. ..$ : int  55 83 154 155 191 390 397 413 414 504 ...
##   .. ..$ : int  11 25 26 28 45 58 59 63 69 110 ...
##   .. ..$ : int  1 4 14 15 17 20 21 30 54 57 ...
##   .. ..$ : int  107 108 113 114 129 388 447 486 569 867 ...
##   .. ..$ : int  72 234 484 663 994 1356 1464 1735
##   .. ..$ : int 1311
##   .. ..$ : int  171 200 304 305 306 346 366 372 402 420 ...
##   .. ..$ : int  379 664 734 764 841 843 1158 1252 1379 1429 ...
##   .. ..$ : int  167 188 367 368 495 553 766 767 838 938 ...
##   .. ..$ : int  60 97 310 409 452 453 454 558 686 936 ...
##   .. ..$ : int  24 38 81 157 256 400 760 768 797 798 ...
##   .. ..$ : int  49 50 51 106 130 147 166 174 175 176 ...
##   .. ..$ : int  3 6 7 8 9 10 82 85 86 87 ...
##   .. ..$ : int  134 146 359 360 537 780 814 1175 1389 1573 ...
##   .. ..$ : int  2 102 168 194 268 281 481 611 701 743 ...
##   .. ..$ : int  115 435 436 570 699 729 1265 1344 1551 1594 ...
##   .. ..$ : int  23 93 140 212 350 355 389 500 531 540 ...
##   .. ..$ : int  135 353 380 404 476 489 522 949 970 1016 ...
##   .. ..$ : int  39 48 385 449 518 520 576 590 628 810 ...
##   .. ..$ : int  31 32 33 42 43 47 62 67 68 78 ...
##   .. ..$ : int  16 29 41 44 161 165 294 337 361 382 ...
##   .. ..$ : int  228 302 442 450 492 718 719 786 813 882 ...
##   .. ..$ : int  199 270 303 1070 1071 1072 1452 1630 1719 1720 ...
##   .. ..$ : int  328 374 443 580 694 695 696 697 698 811 ...
##   .. ..$ : int  27 75 123 214 215 249 322 376 377 393 ...
##   .. ..$ : int  600 1754 2134
##   .. ..$ : int  53 243 325 675 737 769 879 1150 1206 1207 ...
##   .. ..$ : int  642 1234 1323 1324 1325 1391 1797 2345
##   .. ..$ : int  22 259 514 1731 2238 2241 2286 2323
##   .. ..$ : int  244 373 401 630 735 831 870 924 1303 1378 ...
##   .. ..$ : int  40 64 250 347 845 1095 1545 1567 1737 1738
##   .. ..$ : int  5 12 13 84 151 204 226 418 501 556 ...
##   .. ..$ : int  34 37 109 148 251 260 271 272 364 422 ...
##   .. ..$ : int  153 242 284 460 544 575 790 791 801 991 ...
##   .. ..$ : int  116 143 144 170 177 258 273 308 309 329 ...
##   .. ..$ : int  36 73 74 96 141 158 169 182 192 224 ...
##   .. ..$ : int  127 136 265 434 641 648 736 939 940 941 ...
##   .. ..$ : int  46 66 275 554 847 954 1279 1376 1441 1765 ...
##   .. ..$ : int  527 627 733 993 1353 1354 2164
##   .. ..$ : int  830 951 1048 1292 1788 2126
##   .. ..$ : int  18 19 56 70 76 92 133 137 138 139 ...
##   .. ..$ : int  94 95 238 340 341 1001 1002 1007 1499 1724 ...
##   .. ..$ : int  112 315 419 427 445 487 498 543 677 678 ...
##   .. ..$ : int  52 172 183 193 210 211 237 371 491 996 ...
##   .. ..$ : int  159 221 241 248 279 280 333 517 559 610 ...
##   .. ..$ : int  35 80 122 312 369 395 658 668 787 827 ...
##   .. ..$ : int  594 1131
##   .. ..$ : int  391 465 545 915 1040 1414 1539 1728 1729 1818 ...
##   ..- attr(*, &quot;.drop&quot;)= logi TRUE</code></pre>
<pre class="r"><code>ibu_by_states %&gt;% ggplot(aes(y=ABV,x=State)) +
                  geom_boxplot(aes(fill=State), alpha=0.8,show.legend = FALSE) + 
                  labs(title=&quot;Alcohol Content&quot;, 
                  caption=&quot;Beer Analysis&quot;) + 
                  xlab(&quot;State&quot;)+
                  ylab(&quot;Alcohol content&quot;)+
                  theme_wsj()+
                  theme(axis.text.x = element_text(angle=65, vjust=0.6))+  
                  theme(plot.title    = element_text(size = rel(0.5)),
                  plot.subtitle = element_text(size = rel(0.5)),
                  axis.text.x   = element_text(vjust=0.6,size=7),
                  axis.title    = element_text(size = rel(0.5)),
                  legend.position  = &quot;right&quot;,
                  legend.direction =&quot;vertical&quot;,
                  legend.title = element_text(size = rel(0.2)))</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="max-ibu" class="section level3">
<h3>Max IBU</h3>
<pre class="r"><code>max(imputed_df$IBU)</code></pre>
<pre><code>## [1] 157</code></pre>
<pre class="r"><code>which.max(imputed_df$IBU)</code></pre>
<pre><code>## [1] 1569</code></pre>
<pre class="r"><code>print(imputed_df[1569,])</code></pre>
<pre><code>##      Brew_ID             BreweryName    City State
## 1569      52 Upslope Brewing Company Boulder    CO
##                                                  BeerName Beer_ID   ABV
## 1569 Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale    2565 0.128
##      IBU            Style Ounces imputed
## 1569 157 Quadrupel (Quad)   19.2       Y</code></pre>
</div>
<div id="distribution-of-ibu" class="section level3">
<h3>Distribution of IBU</h3>
<p>Boxplot IBU</p>
<pre class="r"><code>ibu_by_states &lt;- imputed_df  %&gt;% group_by(State) %&gt;%  arrange(desc(IBU))
ibu_by_states$State &lt;- factor(ibu_by_states$State, levels = unique(ibu_by_states$State)) 
str(ibu_by_states)</code></pre>
<pre><code>## Classes &#39;grouped_df&#39;, &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:  2348 obs. of  11 variables:
##  $ Brew_ID    : int  52 375 345 231 100 62 273 273 215 18 ...
##  $ BreweryName: Factor w/ 551 levels &quot;10 Barrel Brewing Company&quot;,..: 521 35 545 111 129 469 483 483 103 500 ...
##  $ City       : Factor w/ 384 levels &quot;Abingdon&quot;,&quot;Abita Springs&quot;,..: 43 17 1 134 71 51 363 363 155 113 ...
##  $ State      : Factor w/ 51 levels &quot;CO&quot;,&quot;OR&quot;,&quot;VA&quot;,..: 1 2 3 4 5 6 7 7 8 9 ...
##  $ BeerName   : Factor w/ 2304 levels &quot;#001 Golden Amber Lager&quot;,..: 1181 260 2100 560 203 84 931 931 1340 1501 ...
##  $ Beer_ID    : int  2565 980 1676 2067 2440 15 1111 379 2123 1449 ...
##  $ ABV        : num  0.128 0.082 0.059 0.09 0.089 0.097 0.08 0.08 0.09 0.085 ...
##  $ IBU        : num  157 138 135 130 126 120 120 120 118 115 ...
##  $ Style      : Factor w/ 100 levels &quot;&quot;,&quot;Abbey Single Ale&quot;,..: 84 12 16 12 12 12 12 12 12 12 ...
##  $ Ounces     : num  19.2 12 12 16 12 16 16 16 16 16 ...
##  $ imputed    : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 2 1 1 1 1 1 1 1 1 1 ...
##  - attr(*, &quot;groups&quot;)=Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   51 obs. of  2 variables:
##   ..$ State: Factor w/ 51 levels &quot;AK&quot;,&quot;AL&quot;,&quot;AR&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##   ..$ .rows:List of 51
##   .. ..$ : int  271 285 303 431 473 474 573 736 745 746 ...
##   .. ..$ : int  27 317 430 586 818 1065 1097 1098 1396 1717
##   .. ..$ : int  965 1005 1221 1488 1595
##   .. ..$ : int  52 120 121 267 268 422 499 512 616 712 ...
##   .. ..$ : int  13 28 29 30 54 73 78 84 85 87 ...
##   .. ..$ : int  1 22 24 33 34 35 40 51 56 58 ...
##   .. ..$ : int  142 143 195 196 248 614 670 724 939 987 ...
##   .. ..$ : int  14 177 444 668 1061 1315 2208 2282
##   .. ..$ : int 606
##   .. ..$ : int  159 164 185 223 290 291 292 379 380 381 ...
##   .. ..$ : int  394 571 574 575 854 897 901 1117 1218 1338 ...
##   .. ..$ : int  224 225 342 347 361 405 679 885 903 904 ...
##   .. ..$ : int  55 237 312 626 691 692 784 1075 1096 1389 ...
##   .. ..$ : int  43 44 45 46 68 86 102 158 365 399 ...
##   .. ..$ : int  48 49 50 104 105 123 178 194 205 249 ...
##   .. ..$ : int  10 11 23 91 92 93 115 189 193 198 ...
##   .. ..$ : int  17 81 82 259 484 799 1115 1171 1348 1479 ...
##   .. ..$ : int  165 190 334 335 336 368 665 821 863 874 ...
##   .. ..$ : int  203 498 605 651 725 849 1013 1126 1303 1457 ...
##   .. ..$ : int  4 126 135 166 181 332 369 427 564 565 ...
##   .. ..$ : int  97 524 592 660 673 695 756 785 1037 1083 ...
##   .. ..$ : int  69 90 287 331 407 476 611 731 811 890 ...
##   .. ..$ : int  12 61 62 63 79 80 89 109 150 151 ...
##   .. ..$ : int  6 32 53 96 101 113 124 145 179 206 ...
##   .. ..$ : int  108 167 297 308 367 375 438 676 781 838 ...
##   .. ..$ : int  168 253 378 491 492 766 929 1264 2000 2001 ...
##   .. ..$ : int  174 400 401 418 419 420 518 548 600 601 ...
##   .. ..$ : int  57 140 141 182 216 245 333 408 409 459 ...
##   .. ..$ : int  309 1239 2044
##   .. ..$ : int  107 402 453 545 857 906 1018 1019 1020 1156 ...
##   .. ..$ : int  160 1260 1282 1283 1284 1350 1583 2198
##   .. ..$ : int  42 175 391 1138 1177 1380 2093 2317
##   .. ..$ : int  47 72 256 454 813 855 990 1337 1377 1394 ...
##   .. ..$ : int  70 100 148 460 640 898 955 1169 2210 2211
##   .. ..$ : int  16 25 122 241 264 276 320 322 329 429 ...
##   .. ..$ : int  5 64 67 176 219 261 284 286 341 348 ...
##   .. ..$ : int  41 183 197 266 452 730 1017 1058 1132 1133 ...
##   .. ..$ : int  2 21 26 39 60 75 76 77 98 99 ...
##   .. ..$ : int  15 31 66 71 83 103 125 136 137 139 ...
##   .. ..$ : int  221 325 478 584 585 856 1064 1125 1180 1188 ...
##   .. ..$ : int  88 149 406 525 967 1021 1142 1335 1375 1420 ...
##   .. ..$ : int  700 810 853 1060 1312 1313 1923
##   .. ..$ : int  475 577 1016 1106 1244 1804
##   .. ..$ : int  9 18 19 36 37 38 94 127 128 222 ...
##   .. ..$ : int  152 162 231 232 448 884 1068 1069 1074 1176 ...
##   .. ..$ : int  3 20 110 277 310 392 411 520 521 567 ...
##   .. ..$ : int  7 8 106 172 356 424 447 563 675 771 ...
##   .. ..$ : int  154 163 169 184 236 257 298 299 300 319 ...
##   .. ..$ : int  65 157 173 180 301 426 508 559 620 639 ...
##   .. ..$ : int  270 798
##   .. ..$ : int  235 506 558 617 1095 1237 1604 1672 1857 1979 ...
##   ..- attr(*, &quot;.drop&quot;)= logi TRUE</code></pre>
<pre class="r"><code>ibu_by_states %&gt;% ggplot(aes(y=IBU,x=State)) +
                  geom_boxplot(aes(fill=State), alpha=0.8,show.legend = FALSE) + 
                  labs(title=&quot;IBU&quot;, 
                  caption=&quot;Beer Analysis&quot;) + 
                  xlab(&quot;State&quot;)+
                  ylab(&quot;IBU&quot;)+
                  theme_wsj()+
                  theme(axis.text.x = element_text(angle=65, vjust=0.6))+  
                  theme(plot.title    = element_text(size = rel(0.5)),
                  plot.subtitle = element_text(size = rel(0.5)),
                  axis.text.x   = element_text(vjust=0.6,size=7),
                  axis.title    = element_text(size = rel(0.5)),
                  legend.position  = &quot;right&quot;,
                  legend.direction =&quot;vertical&quot;,
                  legend.title = element_text(size = rel(0.2)))</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="summary-statistics-of-abv" class="section level3">
<h3>Summary Statistics of ABV</h3>
<p>Density plot and Histogram of ABV Distribition</p>
<pre class="r"><code>imputed_df %&gt;% ggplot(aes(x=ABV, fill = State)) +
               geom_histogram(bins=30) + 
               labs(title=&quot;ABV Distribution&quot; 
               ) + 
               ylab(&quot;Alcohol content&quot;)+
               theme_wsj()+
               theme(axis.text.x = element_text(angle=65, vjust=0.6))+  
               theme(plot.title    = element_text(size = rel(0.5)),
               plot.subtitle = element_text(size = rel(0.5)),
               axis.text.x   = element_text(vjust=0.6,size=7),
               axis.title    = element_text(size = rel(0.5)),
               legend.position  = &quot;right&quot;,
               legend.direction =&quot;vertical&quot;,
               legend.title = element_text(size = rel(0.2)))</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>imputed_df %&gt;% ggplot(aes(x=ABV)) +
               geom_density(aes(fill=State), alpha=0.8) + 
               labs(title=&quot;Density Plot&quot;, 
               caption=&quot;Beer Analysis&quot;) + 
               xlab(&quot;State&quot;)+
               ylab(&quot;Alcohol content&quot;)+
               theme_wsj()+
               theme(axis.text.x = element_text(angle=65, vjust=0.6))+  
               theme(plot.title    = element_text(size = rel(0.5)),
               plot.subtitle = element_text(size = rel(0.5)),
               axis.text.x   = element_text(vjust=0.6,size=7),
               axis.title    = element_text(size = rel(0.5)),
               legend.position  = &quot;right&quot;,
               legend.direction =&quot;vertical&quot;,
               legend.title = element_text(size = rel(0.2)))</code></pre>
<pre><code>## Warning: Groups with fewer than two data points have been dropped.</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r"><code>summary(imputed_df$ABV)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.00100 0.05000 0.05600 0.05977 0.06700 0.12800</code></pre>
</div>
<div id="scatterplot-and-correlation-of-abv-vs-ibu" class="section level3">
<h3>Scatterplot and Correlation of ABV vs IBU</h3>
<pre class="r"><code>imputed_df %&gt;% ggplot(aes(x=ABV,y=IBU))+
               geom_point(color = &quot;Red&quot;)+
               theme_wsj()+
               geom_smooth(method=&quot;lm&quot;)+
               labs(title=&quot;ABV Vs. IBU&quot;, 
               caption=&quot;Beer Analysis&quot;) + 
               theme(axis.text.x = element_text(angle=65, vjust=0.3))+  
               theme(plot.title    = element_text(size = rel(0.5)),
               plot.subtitle = element_text(size = rel(0.5)),
               axis.text.x   = element_text(vjust=0.6,size=8),
               axis.text.y   = element_text(vjust=0.2,size=6),
               axis.title    = element_text(size = rel(0.5)),
               legend.position  = &quot;right&quot;,
               legend.direction =&quot;vertical&quot;,
               legend.title = element_text(size = rel(0.5)))</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code>cor(imputed_df$ABV,imputed_df$IBU)</code></pre>
<pre><code>## [1] 0.753397</code></pre>
</div>
<div id="knn-with-cross-validation-and-k-tuning" class="section level3">
<h3>KNN with Cross-validation and K-Tuning</h3>
<p>Confusion Matrix<br />
K Hyper-Parameter tuning plot</p>
<pre class="r"><code>library(e1071)
imputed_df$Style &lt;- toupper(imputed_df$Style)
IPA &lt;- imputed_df %&gt;% filter(str_detect(Style, &quot;IPA&quot;)) 
IPA$Style &lt;- &quot;IPA&quot;
ALE &lt;- imputed_df %&gt;% filter(str_detect(Style, &quot;IPA&quot; , negate = TRUE)) %&gt;% filter(str_detect(Style, &quot;ALE&quot;))
ALE$Style &lt;- &quot;Ale&quot;
mod_df &lt;- rbind(IPA, ALE)
set.seed(7)
iterations = 100
k = 30
Acc_holder = matrix(nrow = iterations, ncol = k)
for(j in 1:iterations)
{
smp &lt;- floor(0.75 * nrow(mod_df))
train_ind &lt;- sample(seq_len(nrow(mod_df)), size = smp)
imputed_train &lt;- mod_df[train_ind, ]
imputed_test &lt;- mod_df[-train_ind, ]
  for(i in 1:k)
  {
  classifications &lt;- knn(imputed_train[,c(7,8)], imputed_test[,c(7,8)], imputed_train$Style,     prob = TRUE, k = i)
  CM &lt;- confusionMatrix(table(classifications, imputed_test$Style))
    Acc_holder[j,i] = CM$overall[1]
  }
}
MeanAcc = colMeans(Acc_holder)
which.max(MeanAcc)</code></pre>
<pre><code>## [1] 7</code></pre>
<pre class="r"><code>k &lt;- c(1:30)
Mean_Acc_df &lt;- data_frame(MeanAcc)</code></pre>
<pre><code>## Warning: `data_frame()` is deprecated, use `tibble()`.
## This warning is displayed once per session.</code></pre>
<pre class="r"><code>Mean_Acc_df &lt;- cbind(k, Mean_Acc_df)
Mean_Acc_df %&gt;% ggplot(aes(x = k, y= MeanAcc)) +
               geom_line(color = &quot;blue&quot;, alpha = .8) +
               labs(title=&quot;Cross-Validating Different KNN Models&quot;, 
               caption=&quot;KNN Score Across K&#39;s&quot;) + 
               xlab(&quot;K&#39;s&quot;)+
               ylab(&quot;Prediction Accuracy&quot;)+
               theme_wsj()+
               theme(axis.text.x = element_text(angle=65, vjust=0.6))+  
               theme(plot.title    = element_text(size = rel(0.5)),
               plot.subtitle = element_text(size = rel(0.5)),
               axis.text.x   = element_text(vjust=0.6,size=7),
               axis.title    = element_text(size = rel(0.5)),
               legend.position  = &quot;right&quot;,
               legend.direction =&quot;vertical&quot;,
               legend.title = element_text(size = rel(0.2)))</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code>classifications &lt;- knn(imputed_train[,c(7,8)], imputed_test[,c(7,8)], imputed_train$Style,     prob = TRUE, k = 6)
CM &lt;- confusionMatrix(table(classifications, imputed_test$Style))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##                
## classifications Ale IPA
##             Ale 205  31
##             IPA  41 107
##                                           
##                Accuracy : 0.8125          
##                  95% CI : (0.7698, 0.8503)
##     No Information Rate : 0.6406          
##     P-Value [Acc &gt; NIR] : 1.206e-13       
##                                           
##                   Kappa : 0.5992          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.2888          
##                                           
##             Sensitivity : 0.8333          
##             Specificity : 0.7754          
##          Pos Pred Value : 0.8686          
##          Neg Pred Value : 0.7230          
##              Prevalence : 0.6406          
##          Detection Rate : 0.5339          
##    Detection Prevalence : 0.6146          
##       Balanced Accuracy : 0.8043          
##                                           
##        &#39;Positive&#39; Class : Ale             
## </code></pre>
</div>
<div id="further-exploration" class="section level3">
<h3>Further exploration</h3>
<p>Separating Beers into known Light and Dark<br />
—Only Beers that are definitely Light or Dark are used</p>
<pre class="r"><code>imputed_df$Style &lt;- toupper(imputed_df$Style)
Blonde &lt;- imputed_df %&gt;%filter(str_detect(Style, &quot;BLONDE&quot;))
Blonde$Style &lt;- &quot;Light&quot;
Light &lt;- imputed_df %&gt;%filter(str_detect(Style, &quot;LIGHT&quot;))
Light$Style &lt;- &quot;Light&quot;
Cream &lt;- imputed_df %&gt;%filter(str_detect(Style, &quot;CREAM&quot;))
Cream$Style &lt;- &quot;Light&quot;
Shandy &lt;- imputed_df %&gt;%filter(str_detect(Style, &quot;SHANDY&quot;))
Shandy$Style &lt;- &quot;Light&quot;
Porter &lt;- imputed_df %&gt;%filter(str_detect(Style, &quot;PORTER&quot;))
Porter$Style &lt;- &quot;Dark&quot;
Stout &lt;- imputed_df %&gt;%filter(str_detect(Style, &quot;STOUT&quot;))
Stout$Style &lt;- &quot;Dark&quot;
Dark &lt;- imputed_df %&gt;%filter(str_detect(Style, &quot;DARK&quot;))
Dark$Style &lt;- &quot;Dark&quot;
Black &lt;- imputed_df %&gt;%filter(str_detect(Style, &quot;BLACK&quot;))
Black$Style &lt;- &quot;Dark&quot;
color &lt;- rbind(Blonde,Light,Porter,Stout,Dark,Black,Cream,Shandy)</code></pre>
</div>
<div id="using-naive-bayes-to-classify-light-vs.-dark-beers" class="section level3">
<h3>Using Naive Bayes to classify Light Vs. Dark Beers</h3>
<p>ROC Curve plot<br />
Confusion Matrix</p>
<pre class="r"><code>iterations = 100
AccHolder = numeric(100)
SensHolder = numeric(100)
SpecHolder = numeric(100)
for(seed in 1:iterations)
{
  set.seed(seed)
    Indices = sample(seq(1:length(color$Style)),round(.75*length(color$Style)))
    train_color = color[Indices,]
    test_color = color[-Indices,]
    model = naiveBayes(train_color[,c(&quot;ABV&quot;, &quot;IBU&quot;, &quot;State&quot;)],factor(train_color$Style, labels     = c(&quot;Light&quot;, &quot;Dark&quot;)))
    CM = confusionMatrix(table(factor(test_color$Style, labels = c(&quot;Light&quot;,   &quot;Dark&quot;)),predict(model,test_color[,c(&quot;ABV&quot;, &quot;IBU&quot;, &quot;State&quot;)])))
    AccHolder[seed] = CM$overall[1]
    SensHolder[seed] = CM$byClass[1]
    SpecHolder[seed] = CM$byClass[2]
}
mean(AccHolder)</code></pre>
<pre><code>## [1] 0.7730526</code></pre>
<pre class="r"><code>mean(SensHolder)</code></pre>
<pre><code>## [1] 0.9046627</code></pre>
<pre class="r"><code>mean(SpecHolder)</code></pre>
<pre><code>## [1] 0.6568694</code></pre>
<pre class="r"><code>which.max(AccHolder)</code></pre>
<pre><code>## [1] 84</code></pre>
<pre class="r"><code>which.max(SensHolder)</code></pre>
<pre><code>## [1] 2</code></pre>
<pre class="r"><code>which.max(SpecHolder)</code></pre>
<pre><code>## [1] 100</code></pre>
<pre class="r"><code>set.seed(38)
Indices = sample(seq(1:length(color$Style)),round(.75*length(color$Style)))
train_color = color[Indices,]
test_color = color[-Indices,]
model = naiveBayes(train_color[,c(&quot;ABV&quot;, &quot;IBU&quot;, &quot;State&quot;)],factor(train_color$Style, labels = c(&quot;Light&quot;, &quot;Dark&quot;)))
CM = confusionMatrix(table(factor(test_color$Style, labels = c(&quot;Light&quot;, &quot;Dark&quot;)),predict(model,test_color[,c(&quot;ABV&quot;, &quot;IBU&quot;, &quot;State&quot;)])))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##        
##         Light Dark
##   Light    39   16
##   Dark      5   35
##                                           
##                Accuracy : 0.7789          
##                  95% CI : (0.6822, 0.8577)
##     No Information Rate : 0.5368          
##     P-Value [Acc &gt; NIR] : 8.711e-07       
##                                           
##                   Kappa : 0.563           
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0291          
##                                           
##             Sensitivity : 0.8864          
##             Specificity : 0.6863          
##          Pos Pred Value : 0.7091          
##          Neg Pred Value : 0.8750          
##              Prevalence : 0.4632          
##          Detection Rate : 0.4105          
##    Detection Prevalence : 0.5789          
##       Balanced Accuracy : 0.7863          
##                                           
##        &#39;Positive&#39; Class : Light           
## </code></pre>
<pre class="r"><code>pred_nb &lt;- predict(model,test_color[,c(&quot;ABV&quot;, &quot;IBU&quot;, &quot;State&quot;)], type = &#39;raw&#39;)
pred &lt;- prediction(pred_nb[, 2], test_color$Style)
nb.prff = performance(pred, &quot;tpr&quot;, &quot;fpr&quot;)
plot(nb.prff,main=&quot;ROC Curve&quot;)</code></pre>
<p><img src="Case-Study-Beer_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
